# 测试指南

本文档提供了验证 DAV Nexus 修复后功能的详细测试步骤。

## 修复验证清单

### 1. 相册同步崩溃修复验证 ✅

#### 测试环境准备

- 准备包含大量照片的设备（建议 1000+ 张照片）
- 确保设备有足够的可用内存
- 连接到 WebDAV 服务器

#### 测试步骤

**基础功能测试**

1. 打开 DAV Nexus 应用
2. 导航到"相册同步"功能
3. 点击"扫描相册"按钮
4. 观察应用是否保持稳定运行

**预期结果**

- ✅ 应用不会崩溃或无响应
- ✅ 扫描进度实时更新
- ✅ 显示已处理的文件数量
- ✅ 如果照片超过 5000 张，显示限制提示
- ✅ 扫描完成后显示统计信息

**内存压力测试**

1. 在包含 5000+ 照片的设备上运行扫描
2. 监控应用内存使用情况
3. 长时间运行扫描功能

**预期结果**

- ✅ 内存使用保持在合理范围内
- ✅ 不会出现内存溢出错误
- ✅ 应用响应始终流畅

### 2. 文件预览功能验证 ✅

#### 测试环境准备

- 在 WebDAV 服务器上准备各种类型的测试文件：
  - 图片文件：`.jpg`, `.png`, `.gif`, `.webp`
  - 视频文件：`.mp4`, `.mov`, `.avi`
  - 文本文件：`.txt`, `.md`, `.json`
  - 其他文件：`.pdf`, `.doc`, `.zip`

#### 测试步骤

**图片预览测试**

1. 在文件列表中点击图片文件
2. 验证是否直接进入预览界面
3. 测试双指缩放功能（0.5x - 3x）
4. 测试拖拽移动功能
5. 测试长按显示操作菜单

**预期结果**

- ✅ 点击图片直接进入预览界面
- ✅ 图片加载正常显示
- ✅ 缩放功能正常工作
- ✅ 拖拽功能正常工作
- ✅ 长按显示操作菜单（下载、重命名、删除）

**视频预览测试**

1. 点击视频文件进入预览
2. 测试播放/暂停功能
3. 测试进度条拖拽
4. 测试控制栏自动隐藏（3 秒后）
5. 点击屏幕重新显示控制栏

**预期结果**

- ✅ 视频正常加载和播放
- ✅ 播放控制按钮正常工作
- ✅ 进度条显示当前播放时间
- ✅ 控制栏自动隐藏和显示
- ✅ 时长格式正确显示

**文本文件测试**

1. 点击文本文件进入预览
2. 验证预览界面显示

**预期结果**

- ✅ 进入预览界面
- ✅ 显示文本预览提示信息

**非预览文件测试**

1. 点击 PDF、Office 文档等非预览文件
2. 验证是否直接显示操作菜单

**预期结果**

- ✅ 直接显示操作菜单
- ✅ 不进入预览界面

### 3. 交互体验验证 ✅

#### 点击行为测试

**文件夹交互**

1. 点击文件夹
2. 长按文件夹

**预期结果**

- ✅ 点击文件夹：进入文件夹
- ✅ 长按文件夹：进入选择模式

**可预览文件交互**

1. 点击图片/视频/文本文件
2. 长按图片/视频/文本文件

**预期结果**

- ✅ 点击：直接进入预览界面
- ✅ 长按：显示操作菜单

**不可预览文件交互**

1. 点击 PDF/Office 文档等
2. 长按不可预览文件

**预期结果**

- ✅ 点击：显示操作菜单
- ✅ 长按：显示操作菜单

### 4. 错误恢复测试 ✅

#### 网络异常测试

1. 在扫描过程中断开网络
2. 恢复网络连接
3. 观察应用反应

**预期结果**

- ✅ 网络错误不会导致应用崩溃
- ✅ 显示合适的错误信息
- ✅ 支持重试机制

#### 文件访问异常测试

1. 在扫描过程中删除一些照片
2. 观察应用处理情况

**预期结果**

- ✅ 单个文件失败不会中断整体流程
- ✅ 跳过无法访问的文件
- ✅ 在日志中记录错误信息

## 性能基准测试

### 内存使用基准

- **相册扫描前**：记录基础内存使用
- **扫描 1000 张照片**：内存增长应 < 100MB
- **扫描 5000 张照片**：内存增长应 < 200MB
- **扫描完成后**：内存应回到合理水平

### 响应时间基准

- **图片预览加载**：< 2 秒
- **视频预览初始化**：< 3 秒
- **操作菜单显示**：< 500ms
- **文件列表刷新**：< 1 秒

## 已知限制

1. **文件数量限制**：单次扫描最多处理 5000 个文件
2. **文件大小限制**：跳过超过 100MB 的文件
3. **文本预览**：当前只显示占位信息，未实现真正的内容预览
4. **视频格式**：某些特殊编码的视频可能无法播放

## 测试报告模板

```
测试环境：
- 设备：[设备型号]
- 操作系统：[iOS/Android/Windows/Web]
- 照片数量：[张数]
- 网络状况：[WiFi/4G/5G]

测试结果：
- [ ] 相册扫描不崩溃
- [ ] 内存使用正常
- [ ] 图片预览正常
- [ ] 视频播放正常
- [ ] 交互体验符合预期
- [ ] 错误处理正常

发现问题：
1. [问题描述]
2. [问题描述]

总体评价：[通过/有问题]
```

## 联系信息

如果在测试过程中发现问题，请联系开发团队或在 GitHub 上提交 Issue。

---

**测试指南版本**：v1.0.0  
**适用版本**：DAV Nexus v1.0.0+1  
**更新时间**：2024 年 12 月 19 日
